# 投资年化收益率计算器

一个基于 React + Antd + Vite 开发的投资年化收益率计算器，支持两种计算模式：收益计算和定投计算。

## 功能特性

### 1. 收益计算
- 支持设置初始投资金额
- 支持设置开始日期和结束日期
- 支持动态添加中间投资记录
- 自动计算年化收益率、总投入、总收益和最终金额
- 显示投资天数

### 2. 定投计算
- 支持设置初始金额
- 支持设置定投金额
- 支持选择投资期限范围（开始日期和结束日期）
- 支持多种投资频率：每天、每周、每两周、每月、每季度、每年
- 支持输入当前金额，反向计算年化收益率
- 自动计算年化收益率、总投入、总收益和最终金额
- 显示投资天数

### 3. 其他功能
- 支持计算历史记录保存和管理
- 支持表单一键重置
- 响应式设计，适配 PC 和移动端
- 简洁清晰的用户界面

## 计算公式

### 1. 收益计算

#### 1.1 单笔投资（无追加投资）

当没有追加投资时，使用**复合年增长率（CAGR）**公式计算年化收益率：

$$
\text{年化收益率} = \left(\left(\frac{\text{结束金额}}{\text{初始金额}}\right)^{\frac{365}{\text{投资天数}}} - 1\right) \times 100
$$

**说明**：
- `^` 表示幂运算
- `365` 表示每年的天数
- `投资天数` 是结束日期减去开始日期的天数

#### 1.2 多笔投资（有追加投资）

当有追加投资时，使用**扩展内部收益率（XIRR）**算法计算年化收益率：

$$
\sum_{i=1}^{n} \frac{CF_i}{(1 + r)^{\frac{d_i}{365}}} = 0
$$

**说明**：
- `CF_i` 表示第 `i` 笔现金流（初始投资和追加投资为负数，最终金额为正数）
- `r` 表示年化收益率（需要求解的未知数）
- `d_i` 表示第 `i` 笔现金流距离第一笔现金流的天数
- 该方程使用牛顿-拉夫森迭代法求解

### 2. 定投计算

定投计算使用**牛顿-拉夫森迭代法**求解非线性方程，得到年化收益率：

$$
\text{当前金额} = \text{初始金额} \times \left(1 + \frac{\text{年化收益率}}{\text{每年期数}}\right)^{\text{总期数}} + \text{每期定投金额} \times \frac{\left(1 + \frac{\text{年化收益率}}{\text{每年期数}}\right)^{\text{总期数}} - 1}{\frac{\text{年化收益率}}{\text{每年期数}}}
$$

**说明**：
- `每年期数` 对应不同的投资频率：
  - 每天：365期
  - 每周：52期
  - 每两周：26期
  - 每月：12期
  - 每季度：4期
  - 每年：1期
- `总期数` = Math.floor((投资月数 / 12) * 每年期数)

## 技术栈

- **React 18**：用于构建用户界面
- **Ant Design**：提供 UI 组件
- **Vite**：构建工具
- **dayjs**：日期处理库

## 安装和运行

### 安装依赖

```bash
npm install
```

### 启动开发服务器

```bash
npm run dev
```

开发服务器将在 http://localhost:5173 启动（如果端口被占用，会自动尝试其他端口）。

### 构建生产版本

```bash
npm run build
```

构建产物将输出到 `dist` 目录。

### 预览生产版本

```bash
npm run preview
```

## 使用说明

### 收益计算模式
1. 选择「收益计算」选项卡
2. 输入初始投资金额
3. 选择开始日期和结束日期
4. 输入结束金额
5. 点击「添加投资」可以添加中间投资记录
6. 系统会自动计算出年化收益率、总投入、总收益、最终金额和投资天数
7. 点击「保存到历史记录」可以保存当前计算

### 定投计算模式
1. 选择「定投计算」选项卡
2. 输入初始金额
3. 输入定投金额
4. 选择投资期限范围（开始日期和结束日期）
5. 选择投资频率
6. 输入当前金额
7. 系统会自动计算出年化收益率、总投入、总收益、最终金额和投资天数
8. 点击「保存到历史记录」可以保存当前计算

## 项目结构

```
├── src/
│   ├── utils/
│   │   └── calculator.js    # 计算工具函数
│   ├── App.jsx              # 主应用组件
│   ├── App.css              # 应用样式
│   ├── index.css            # 全局样式
│   └── main.jsx             # 应用入口
├── index.html               # HTML 模板
├── package.json             # 项目配置
├── vite.config.js           # Vite 配置
└── README.md                # 项目说明
```

## 许可证

MIT
